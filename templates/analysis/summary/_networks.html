{% load analysis_tags %}

<div>
    <div class="static-summary-header">
      <span class="header—symbol"></span>
      <span class="header—title">网络通信</span>
    </div>
    <div class="network-events">
{% for signature in analysis.signatures %}
    {% if signature.severity > 2 %}
        <a style="text-decoration: none;" href="#signature_{{signature.name}}" data-toggle="collapse">
            <div class="alert-warning signature">
                {{signature.description}}
                {% if signature.marks %}
                    {% if signature.marks|length == 1 %}
                        (1 个事件)
                    {% elif signature.markcount == signature.marks|length %}
                        ({{ signature.marks|length }} 个事件)
                    {% elif signature.markcount %}
                        ({{ signature.marks|length }} out of {{ signature.markcount }} 个事件)
                    {% else %}
                        ({{ signature.marks|length }} 个事件)
                    {% endif %}
                {% endif %}
            </div>
        </a>

        <div id="signature_{{signature.name}}" class="collapse">
            <table class="table table-bordered" style="table-layout: fixed;">
                {% for mark in signature.marks|sigsort %}
                    {% if mark.type == "call" %}
                        {% if mark.first %}
                            <thead>
                                <tr>
                                    <th width="15%">Time &amp; API</th>
                                    <th width="65%">Arguments</th>
                                    <th width="5%">Status</th>
                                    <th width="10%">Return</th>
                                    <th width="5%">Repeated</th>
                                </tr>
                            </thead>
                        {% endif %}
                        <tr>
                            {% include "analysis/behavior/_api_call.html" with call=mark.call pid=mark.pid cid=mark.cid %}
                        </tr>
                    {% elif mark.type == "ioc" %}
                        <tr>
                            <td>{{ mark.category }}</td>
                            <td>{{ mark.ioc }}</td>
                            {% if mark.description %}
                                <td>{{ mark.description }}</td>
                            {% endif %}
                        </tr>
                    {% elif mark.type == "generic" %}
                        <tr>
                            {% for key, value in mark.items %}
                                {% if key != "type" %}
                                    <td colspan="1">{{ key }}</td>
                                    <td colspan="4">{{ value }}</td>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endif %}
                {% endfor %}
            </table>
        </div>
    {% endif %}
{% endfor %}
</div>

</div>